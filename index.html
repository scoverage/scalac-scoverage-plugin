<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>scct - Scala Code Coverage Tool</title>
	<meta name="author" content="Mikko Koponen" />
	<meta name="keywords" content="mtkopone scct scala code coverage tool codecoverage" />	
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.1/build/reset-fonts-grids/reset-fonts-grids.css">
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.1/build/base/base-min.css">
  <link type="text/css" href="css/jquery-ui-1.8.13.custom.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="style.css">
  <script type="text/javascript" src="js/jquery-1.5.1.min.js"></script>
  <script type="text/javascript" src="js/jquery-ui-1.8.13.custom.min.js"></script>
  <script type="text/javascript">
		$(function(){
			$('.usage-tab').tabs().hide();
			$('.usage-tab:first').show();
			$('#usage-buttons button').button().click(function() {
			  $('#usage-buttons button').removeClass('selected');
			  $(this).addClass('selected');
			  $('.usage-tab').hide();
			  $('#'+$(this).attr('id').substring(2)).show();
			});
		});
  </script>
</head>
<body>
	<div id="doc3" class="yui-t3">
		<div id="bd">
			<div class="yui-b">
				<h1 class="h">scct</h1>
				<h3 class="h">Scala Code Coverage Tool</h3>
				<h3 class="h">&lt;Name_Pending&gt;</h3>
        <h3 class="h"><a href="maven-repo/">maven-repo</a></h3>
			</div>	
			<div id="yui-main">
				<div id="beef" class="yui-b">
	
  <a href="http://github.com/mtkopone/scct">
		<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
	</a>
  <div id="container">
		<h2>Eh?</h2>
		<p><span class="mono">scct</span> is a code coverage tool for Scala.</p>
		<h2>News</h2>
    <p><span class="news ui-state-default ui-corner-all">Aug 2, 2012</span> 0.2-SNAPSHOT is out! Multiproject goodness for both sbt and maven.</p>
    <p><span class="news ui-state-default ui-corner-all">Feb 25, 2012</span> Instructions for Maven updated, should work properly now.</p>
		<p><span class="news ui-state-default ui-corner-all">Nov 12, 2011</span> Scala 2.9.1 support.</p>
		<p><span class="news ui-state-default ui-corner-all">Jun 4, 2011</span> Now <del>theoretically</del> supports scala 2.9.0-1 and up. Give it a try!</p>
		<h2>What's it look like?</h2>
		<p><a href="report/index.html" target="_blank"><img src="screenshot.png" alt="scct-screenshot" class="screenshot"/></a></p>
		<h2>What's missing?</h2>
		<p>Mainly, a better-lookin' report UI, a simpler maven configuration.</p>
    
    <h2>Usage</h2>

    <p>The current 0.2-SNAPSHOT version of <span class="mono">scct</span> and it's build-tool plugins for sbt and maven only support scala 2.9 and up, sbt 0.12 and up, and maven 3.0.3 and up.</p>

    <p>(The old 0.1-SNAPSHOT version supported older versions of scala and sbt. Instructions for the 0.1-SNAPSHOT version are <a href="legacy.html">here</a>.)</p>

    <div id="usage-tabs" class="usage-tab">
			<ul>
				<li><a href="#usage-tabs-1">sbt 0.12+</a></li>
				<li><a href="#usage-tabs-2">maven</a></li>
				<li><a href="#usage-tabs-3">standalone</a></li>
			</ul>
    	<div id="usage-tabs-1">
        <h3>Firstly...</h3>
        <p>Add the plugin to your build with the following in <span class="mono">project/build.sbt</span>:</p>
				<pre>
resolvers += Classpaths.typesafeResolver

resolvers += "scct-github-repository" at "http://mtkopone.github.com/scct/maven-repo"

addSbtPlugin("reaktor" % "sbt-scct" % "0.2-SNAPSHOT")
				</pre>
				<h3>Single project builds</h3>
        <p>Add the plugin settings to your project, at <span class="mono">build.sbt</span>:</p>
        <pre>
seq(ScctPlugin.instrumentSettings : _*)
        </pre>
        <p>Run your unit tests with:</p><pre>$ sbt clean scct:test</pre>
				<p>Then open:</p><pre>./target/scala_2.9.2/coverage-report/index.html</pre>
        <h3>Multiproject builds</h3>
        <p>Add the plugin instrumentation settings to child projects and the report merging settings to the parent project.</p>
        <p>For example <span class="mono">project/MyBuild.scala</span>:</p>
        <pre>
object MyBuild extends Build {
  lazy val root = Project(id = "parent", base = file("."))
      settings (ScctPlugin.mergeReportSettings: _*) aggregate(first, second)

  lazy val firstChild = Project(id = "firstchild", base = file("first"))
      settings (ScctPlugin.instrumentSettings: _*)

  lazy val secondChild = Project(id = "secondchild", base = file("second"))
      settings (ScctPlugin.instrumentSettings: _*)
}
        </pre>
        <p>Run coverage for all child projects with:</p><pre>$ sbt clean scct:test</pre>
        <p>This creates individual coverage reports into <span class="mono">$childProjectDir/target/scala_&lt;ver&gt;/coverage-report/</span></p>
        <p>Merge all the existing child reports into <span class="mono">$parentProjectDir/target/scala_&lt;ver&gt;/coverage-report/</span> with:</p>
        <pre>$ sbt scct-merge-report</pre>
        <h3>...Enjoy</h3>

      </div>
			<div id="usage-tabs-2">
        <h3>Firstly...</h3>
				<p>Assuming you are using <span class="mono">maven-scala-plugin</span>...</p>
				<p>First, make sure your main and test scalac binding goals are separated in the plugin configuration and have referenceable ID's, so we can extend the main compilation with instrumentation support. Something like this:
				<pre>
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.scala-tools&lt;/groupId&gt;
      &lt;artifactId&gt;maven-scala-plugin&lt;/artifactId&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;<span class="hilite">main-scalac</span>&lt;/id&gt;
          &lt;goals&gt;&lt;goal&gt;compile&lt;/goal&gt;&lt;/goals&gt;
        &lt;/execution&gt;
        &lt;execution&gt;
          &lt;id&gt;test-scalac&lt;/id&gt;
          &lt;goals&gt;&lt;goal&gt;testCompile&lt;/goal&gt;&lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
				</pre>
				<p>Then add a custom profile which binds the coverage instrumentation to the main compilation goal by ID, and sets all the necessary environment variables for the test run:
				<pre>
&lt;profiles&gt;
  &lt;profile&gt;
    &lt;id&gt;coverage&lt;/id&gt;
    &lt;repositories&gt;
      &lt;repository&gt;
        &lt;id&gt;scct-repo&lt;/id&gt;
        &lt;url&gt;http://mtkopone.github.com/scct/maven-repo&lt;/url&gt;
      &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;dependencies&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;reaktor&lt;/groupId&gt;
        &lt;artifactId&gt;scct_2.9.2&lt;/artifactId&gt;
        &lt;version&gt;0.2-SNAPSHOT&lt;/version&gt;
      &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;build&gt;
      &lt;plugins&gt;
        &lt;plugin&gt;
          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
          &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
          &lt;version&gt;2.6&lt;/version&gt;
          &lt;configuration&gt;
            &lt;systemPropertyVariables&gt;
              &lt;scct.project.name&gt;${project.name}&lt;/scct.project.name&gt;
              &lt;scct.coverage.file&gt;${project.build.outputDirectory}/coverage.data&lt;/scct.coverage.file&gt;
              &lt;scct.report.dir&gt;${project.build.directory}/coverage-report&lt;/scct.report.dir&gt;
              &lt;scct.source.dir&gt;${project.build.sourceDirectory}&lt;/scct.source.dir&gt;
            &lt;/systemPropertyVariables&gt;
          &lt;/configuration&gt;
        &lt;/plugin&gt;
        &lt;plugin&gt;
          &lt;groupId&gt;org.scala-tools&lt;/groupId&gt;
          &lt;artifactId&gt;maven-scala-plugin&lt;/artifactId&gt;
          &lt;executions&gt;
            &lt;execution&gt;
              &lt;id&gt;<span class="hilite">main-scalac</span>&lt;/id&gt;
              &lt;configuration&gt;
                &lt;args&gt;
                  &lt;args&gt;-P:scct:projectId:${project.name}&lt;/args&gt;
                  &lt;args&gt;-P:scct:basedir:${project.basedir}&lt;/args&gt;
                &lt;/args&gt;
                &lt;compilerPlugins&gt;
                  &lt;compilerPlugin&gt;
                    &lt;groupId&gt;reaktor&lt;/groupId&gt;
                    &lt;artifactId&gt;scct_2.9.2&lt;/artifactId&gt;
                    &lt;version&gt;0.2-SNAPSHOT&lt;/version&gt;
                  &lt;/compilerPlugin&gt;
                &lt;/compilerPlugins&gt;
              &lt;/configuration&gt;
            &lt;/execution&gt;
          &lt;/executions&gt;
        &lt;/plugin&gt;
      &lt;/plugins&gt;
    &lt;/build&gt;
  &lt;/profile&gt;
&lt;/profiles&gt;
				</pre>
				<p>Run your unit tests with:</p><pre>$ mvn -Pcoverage clean test</pre>
				<p>Then open:</p><pre>./target/coverage-report/index.html</pre>

        <h3>Multiproject builds</h3>
        <p>Add the following bits and pieces to your parent pom:</p>
        <pre>
&lt;pluginRepositories&gt;
  &lt;pluginRepository&gt;
    &lt;id&gt;scct-plugin-repo&lt;/id&gt;
    &lt;url&gt;http://mtkopone.github.com/scct/maven-repo&lt;/url&gt;
  &lt;/pluginRepository&gt;
&lt;/pluginRepositories&gt;
...
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
      &lt;artifactId&gt;maven-site-plugin&lt;/artifactId&gt;
      &lt;version&gt;3.1&lt;/version&gt;
      &lt;configuration&gt;
        &lt;reportPlugins&gt;
          &lt;plugin&gt;
            &lt;groupId&gt;reaktor.scct&lt;/groupId&gt;
            &lt;artifactId&gt;maven-scct-multiproject-report&lt;/artifactId&gt;
            &lt;version&gt;2.0-SNAPSHOT&lt;/version&gt;
          &lt;/plugin&gt;
        &lt;/reportPlugins&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
        </pre>
        <p>Then run coverage for all child projects with:</p><pre>$ mvn -Pcoverage clean test</pre>
        <p>This creates individual coverage reports into <span class="mono">$childProjectDir/target/coverage-report/</span></p>
        <p>Merge all the existing child reports into <span class="mono">$parentProjectDir/target/site/coverage-report/</span> with:</p>
        <pre>$ mvn reaktor.scct:maven-scct-multiproject-report:scct-report</pre>
        <h3>...Enjoy.</h3>
			</div>
			<div id="usage-tabs-3">
				<p>Download <a href="http://mtkopone.github.com/scct/maven-repo/reaktor/scct_2.9.2/0.2-SNAPSHOT/scct_2.9.2-0.2-SNAPSHOT.jar">scct</a> jar.
			  <p>Compile and instrument your source:</p>
				<pre>
$ scalac -Xplugin:scct_2.9.2-0.2-SNAPSHOT.jar \\
	  -classpath .:scct_2.9.2-0.2-SNAPSHOT.jar Test.scala
				</pre>
				<p>Run something:</p>
				<pre>$ scala -classpath .:scct_2.9.2-0.2-SNAPSHOT.jar Test</pre>
				<p>Then open:</p><pre>./index.html</pre>
			</div>
		</div>
  </div>
	<div id="foot">
		&copy; <a href="http://github.com/mtkopone">Mikko Koponen</a> 2011
    | Layout by <a href="http://developer.yahoo.com/yui/license.html">yui</a>
	</div>

			</div>
		</div>
	</div>
</div>

  <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-16694728-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
